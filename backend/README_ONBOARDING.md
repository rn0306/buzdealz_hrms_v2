Onboarding API - Buzdealz HRMS

This document describes the onboarding-related APIs and how to use them (Recruiter/Hr actions and Candidate actions).

Base URL: http://localhost:3000/api/onboarding

Authentication
- HR/Recruiter/Admin endpoints require a JWT in header: Authorization: Bearer <token>
- Candidate actions use an onboarding token issued after recruiter selects candidate: provided as query param ?token=<token>

Endpoints

1) Recruiter: Create Candidate + User (auto password)
POST /create-candidate
Auth: JWT (RECRUITER or ADMIN)
Body (application/json):
{
  "full_name": "John Doe",
  "email": "john@example.com",
  "phone": "9876543210",
  "resume_url": "https://s3.amazonaws.com/...",
  "source": "portal",
  "assigned_recruiter": "<recruiter_user_id>" // optional
}
Response (201):
{
  "message": "Candidate and user created",
  "candidate": { ... },
  "user": {
    "id": "...",
    "email": "john@example.com",
    "tempPassword": "AutoGeneratedPwd123!"
  }
}
Note: In production you should email the generated password securely and not return it in the response.

2) HR selects candidate as Selected
POST /select/:candidateId
Auth: JWT (RECRUITER or ADMIN)
Response:
{
  "message": "Candidate marked as Selected",
  "onboarding_link": "/api/onboarding/upload/<candidateId>?token=<onboarding_token>"
}

3) Candidate uploads documents
POST /upload/:candidateId?token=<onboarding_token>
Body (application/json):
{
  "id_proof_url": "https://s3.amazonaws.com/id.jpg",
  "bank_account_number": "1234567890",
  "ifsc_code": "SBIN0001234",
  "pan_number": "ABCDE1234F",
  "aadhaar_number": "123412341234"
}
Response:
{ "message": "Documents uploaded. Awaiting verification." }

4) HR verifies documents
POST /verify/:candidateId
Auth: JWT (RECRUITER or ADMIN)
Body:
{ "status": "Verified" } // or "Rejected"
Response (if verified):
{
  "message": "Documents verified.",
  "offer_letter": "/offers/offer_<candidateId>.pdf"
}

5) Candidate accepts offer
POST /accept-offer/:candidateId?token=<onboarding_token>
Response:
{ "message": "Offer accepted. Welcome!" }

6) Candidate sets/updates password (after onboarding)
POST /set-password/:candidateId?token=<onboarding_token>
Body:
{ "new_password": "MySecureNewPass123" }
Response:
{ "message": "Password updated successfully" }

How to test quickly (example curl commands)

1) Create candidate (Recruiter)
curl -X POST http://localhost:3000/api/onboarding/create-candidate \
 -H "Authorization: Bearer <recruiter_jwt>" \
 -H "Content-Type: application/json" \
 -d '{"full_name":"John Doe","email":"john@example.com","phone":"9876543210"}'

2) Select candidate
curl -X POST http://localhost:3000/api/onboarding/select/<candidateId> \
 -H "Authorization: Bearer <recruiter_jwt>"

3) Upload docs (candidate)
curl -X POST "http://localhost:3000/api/onboarding/upload/<candidateId>?token=<onboarding_token>" \
 -H "Content-Type: application/json" \
 -d '{"id_proof_url":"https://s3/id.jpg","bank_account_number":"123456"}'

Notes and next steps
- The generated passwords are returned in responses for development only. Replace this with a secure email workflow.
- Consider adding expiry and single-use semantics to onboarding tokens.
- Add file upload endpoints (multipart/form-data) to store documents to S3.
- Wire offer letter PDF generation using your preferred PDF generator.

